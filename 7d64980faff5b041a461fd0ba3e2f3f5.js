ace.define("ace/ext/code_lens",["require","exports","module","ace/line_widgets","ace/lib/event","ace/lib/lang","ace/lib/dom","ace/editor","ace/config"],(function(e,n,t){"use strict";var o=e("../line_widgets").LineWidgets,r=e("../lib/event"),s=e("../lib/lang"),i=e("../lib/dom");function clearLensElements(e){var n=e.$textLayer,t=n.$lenses;t&&t.forEach((function(e){e.remove()})),n.$lenses=null}function renderWidgets(e,n){if(e&n.CHANGE_LINES||e&n.CHANGE_FULL||e&n.CHANGE_SCROLL||e&n.CHANGE_TEXT){var t=n.session,o=n.session.lineWidgets,r=n.$textLayer,s=r.$lenses;if(o){var a=n.$textLayer.$lines.cells,d=n.layerConfig,c=n.$padding;s||(s=r.$lenses=[]);for(var l=0,u=0;u<a.length;u++){var g=a[u].row,f=o[g],L=f&&f.lenses;if(L&&L.length){var p=s[l];p||(p=s[l]=i.buildDom(["div",{class:"ace_codeLens"}],n.container)),p.style.height=d.lineHeight+"px",l++;for(var v=0;v<L.length;v++){var h=p.childNodes[2*v];h||(0!=v&&p.appendChild(i.createTextNode(" | ")),h=i.buildDom(["a"],p)),h.textContent=L[v].title,h.lensCommand=L[v]}for(;p.childNodes.length>2*v-1;)p.lastChild.remove();var m=n.$cursorLayer.getPixelPosition({row:g,column:0},!0).top-d.lineHeight*f.rowsAbove-d.offset;p.style.top=m+"px";var C=n.gutterWidth,$=t.getLine(g).search(/\S|$/);-1==$&&($=0),C+=$*d.characterWidth,p.style.paddingLeft=c+C+"px"}}for(;l<s.length;)s.pop().remove()}else s&&clearLensElements(n)}}function clearCodeLensWidgets(e){if(e.lineWidgets){var n=e.widgetManager;e.lineWidgets.forEach((function(e){e&&e.lenses&&n.removeLineWidget(e)}))}}function attachToEditor(e){e.codeLensProviders=[],e.renderer.on("afterRender",renderWidgets),e.$codeLensClickHandler||(e.$codeLensClickHandler=function(n){var t=n.target.lensCommand;t&&(e.execCommand(t.id,t.arguments),e._emit("codeLensClick",n))},r.addListener(e.container,"click",e.$codeLensClickHandler,e)),e.$updateLenses=function(){var t=e.session;if(t){t.widgetManager||(t.widgetManager=new o(t),t.widgetManager.attach(e));var r=e.codeLensProviders.length,s=[];e.codeLensProviders.forEach((function(e){e.provideCodeLenses(t,(function(e,n){e||(n.forEach((function(e){s.push(e)})),0==--r&&applyLenses())}))}))}function applyLenses(){var o=t.selection.cursor,r=t.documentToScreenRow(o),i=t.getScrollTop(),a=n.setLenses(t,s),d=t.$undoManager&&t.$undoManager.$lastDelta;if(!(d&&"remove"==d.action&&d.lines.length>1)){var c=t.documentToScreenRow(o),l=e.renderer.layerConfig.lineHeight,u=t.getScrollTop()+(c-r)*l;0==a&&i<l/4&&i>-l/4&&(u=-l),t.setScrollTop(u)}}};var t=s.delayedCall(e.$updateLenses);e.$updateLensesOnInput=function(){t.delay(250)},e.on("input",e.$updateLensesOnInput)}n.setLenses=function(e,n){var t=Number.MAX_VALUE;return clearCodeLensWidgets(e),n&&n.forEach((function(n){var o=n.start.row,r=n.start.column,s=e.lineWidgets&&e.lineWidgets[o];s&&s.lenses||(s=e.widgetManager.$registerLineWidget({rowCount:1,rowsAbove:1,row:o,column:r,lenses:[]})),s.lenses.push(n.command),o<t&&(t=o)})),e._emit("changeFold",{data:{start:{row:t}}}),t},n.registerCodeLensProvider=function(e,n){e.setOption("enableCodeLens",!0),e.codeLensProviders.push(n),e.$updateLensesOnInput()},n.clear=function(e){n.setLenses(e,null)};var a=e("../editor").Editor;e("../config").defineOptions(a.prototype,"editor",{enableCodeLens:{set:function(e){var n;e?attachToEditor(this):((n=this).off("input",n.$updateLensesOnInput),n.renderer.off("afterRender",renderWidgets),n.$codeLensClickHandler&&n.container.removeEventListener("click",n.$codeLensClickHandler))}}}),i.importCssString("\n.ace_codeLens {\n    position: absolute;\n    color: #aaa;\n    font-size: 88%;\n    background: inherit;\n    width: 100%;\n    display: flex;\n    align-items: flex-end;\n    pointer-events: none;\n}\n.ace_codeLens > a {\n    cursor: pointer;\n    pointer-events: auto;\n}\n.ace_codeLens > a:hover {\n    color: #0000ff;\n    text-decoration: underline;\n}\n.ace_dark > .ace_codeLens > a:hover {\n    color: #4e94ce;\n}\n","codelense.css",!1)})),ace.require(["ace/ext/code_lens"],(function(e){"object"==typeof module&&"object"==typeof exports&&module&&(module.exports=e)}));