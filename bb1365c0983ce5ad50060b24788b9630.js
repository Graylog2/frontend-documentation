ace.define("ace/ext/command_bar",["require","exports","module","ace/tooltip","ace/lib/event_emitter","ace/lib/lang","ace/lib/dom","ace/lib/oop","ace/lib/useragent"],(function(t,o,e){var i=this&&this.__values||function(t){var o="function"==typeof Symbol&&Symbol.iterator,e=o&&t[o],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},n=t("../tooltip").Tooltip,s=t("../lib/event_emitter").EventEmitter,r=t("../lib/lang"),a=t("../lib/dom"),l=t("../lib/oop"),h=t("../lib/useragent"),d="command_bar_tooltip_button",c="command_bar_button_value",p="command_bar_button_caption",m="command_bar_keybinding",u="command_bar_tooltip",f="MoreOptionsButton",minPosition=function(t,o){return o.row>t.row||o.row===t.row&&o.column>t.column?t:o},g={Ctrl:{mac:"^"},Option:{mac:"⌥"},Command:{mac:"⌘"},Cmd:{mac:"⌘"},Shift:"⇧",Left:"←",Right:"→",Up:"↑",Down:"↓"},v=function(){function CommandBarTooltip(t,o){var e,s;o=o||{},this.parentNode=t,this.tooltip=new n(this.parentNode),this.moreOptions=new n(this.parentNode),this.maxElementsOnTooltip=o.maxElementsOnTooltip||4,this.$alwaysShow=o.alwaysShow||!1,this.eventListeners={},this.elements={},this.commands={},this.tooltipEl=a.buildDom(["div",{class:u}],this.tooltip.getElement()),this.moreOptionsEl=a.buildDom(["div",{class:"command_bar_tooltip tooltip_more_options"}],this.moreOptions.getElement()),this.$showTooltipTimer=r.delayedCall(this.$showTooltip.bind(this),o.showDelay||100),this.$hideTooltipTimer=r.delayedCall(this.$hideTooltip.bind(this),o.hideDelay||100),this.$tooltipEnter=this.$tooltipEnter.bind(this),this.$onMouseMove=this.$onMouseMove.bind(this),this.$onChangeScroll=this.$onChangeScroll.bind(this),this.$onEditorChangeSession=this.$onEditorChangeSession.bind(this),this.$scheduleTooltipForHide=this.$scheduleTooltipForHide.bind(this),this.$preventMouseEvent=this.$preventMouseEvent.bind(this);try{for(var l=i(["mousedown","mouseup","click"]),h=l.next();!h.done;h=l.next()){var d=h.value;this.tooltip.getElement().addEventListener(d,this.$preventMouseEvent),this.moreOptions.getElement().addEventListener(d,this.$preventMouseEvent)}}catch(t){e={error:t}}finally{try{h&&!h.done&&(s=l.return)&&s.call(l)}finally{if(e)throw e.error}}}return CommandBarTooltip.prototype.registerCommand=function(t,o){var e=Object.keys(this.commands).length<this.maxElementsOnTooltip;e||this.elements.MoreOptionsButton||this.$createCommand(f,{name:"···",exec:function(){this.$shouldHideMoreOptions=!1,this.$setMoreOptionsVisibility(!this.isMoreOptionsShown())}.bind(this),type:"checkbox",getValue:function(){return this.isMoreOptionsShown()}.bind(this),enabled:!0},!0),this.$createCommand(t,o,e),this.isShown()&&this.updatePosition()},CommandBarTooltip.prototype.isShown=function(){return!!this.tooltip&&this.tooltip.isOpen},CommandBarTooltip.prototype.isMoreOptionsShown=function(){return!!this.moreOptions&&this.moreOptions.isOpen},CommandBarTooltip.prototype.getAlwaysShow=function(){return this.$alwaysShow},CommandBarTooltip.prototype.setAlwaysShow=function(t){this.$alwaysShow=t,this.$updateOnHoverHandlers(!this.$alwaysShow),this._signal("alwaysShow",this.$alwaysShow)},CommandBarTooltip.prototype.attach=function(t){!t||this.isShown()&&this.editor===t||(this.detach(),this.editor=t,this.editor.on("changeSession",this.$onEditorChangeSession),this.editor.session&&(this.editor.session.on("changeScrollLeft",this.$onChangeScroll),this.editor.session.on("changeScrollTop",this.$onChangeScroll)),this.getAlwaysShow()?this.$showTooltip():this.$updateOnHoverHandlers(!0))},CommandBarTooltip.prototype.updatePosition=function(){if(this.editor){var t,o=this.editor.renderer;if((t=this.editor.selection.getAllRanges?this.editor.selection.getAllRanges():[this.editor.getSelectionRange()]).length){for(var e,i=minPosition(t[0].start,t[0].end),n=0;e=t[n];n++)i=minPosition(i,minPosition(e.start,e.end));var s=o.$cursorLayer.getPixelPosition(i,!0),r=this.tooltip.getElement(),a=window.innerWidth,l=window.innerHeight,h=this.editor.container.getBoundingClientRect();s.top+=h.top-o.layerConfig.offset,s.left+=h.left+o.gutterWidth-o.scrollLeft;var d=s.top>=h.top&&s.top<=h.bottom&&s.left>=h.left+o.gutterWidth&&s.left<=h.right;if(d||!this.isShown())if(d&&!this.isShown()&&this.getAlwaysShow())this.$showTooltip();else{var c=s.top-r.offsetHeight,p=Math.min(a-r.offsetWidth,s.left);if(c>=0&&c+r.offsetHeight<=l&&p>=0&&p+r.offsetWidth<=a){if(this.tooltip.setPosition(p,c),this.isMoreOptionsShown()){c+=r.offsetHeight,p=this.elements.MoreOptionsButton.getBoundingClientRect().left;var m=this.moreOptions.getElement();l=window.innerHeight;c+m.offsetHeight>l&&(c-=r.offsetHeight+m.offsetHeight),p+m.offsetWidth>a&&(p=a-m.offsetWidth),this.moreOptions.setPosition(p,c)}}else this.$hideTooltip()}else this.$hideTooltip()}}},CommandBarTooltip.prototype.update=function(){Object.keys(this.elements).forEach(this.$updateElement.bind(this))},CommandBarTooltip.prototype.detach=function(){this.tooltip.hide(),this.moreOptions.hide(),this.$updateOnHoverHandlers(!1),this.editor&&(this.editor.off("changeSession",this.$onEditorChangeSession),this.editor.session&&(this.editor.session.off("changeScrollLeft",this.$onChangeScroll),this.editor.session.off("changeScrollTop",this.$onChangeScroll))),this.$mouseInTooltip=!1,this.editor=null},CommandBarTooltip.prototype.destroy=function(){this.tooltip&&this.moreOptions&&(this.detach(),this.tooltip.destroy(),this.moreOptions.destroy()),this.eventListeners={},this.commands={},this.elements={},this.tooltip=this.moreOptions=this.parentNode=null},CommandBarTooltip.prototype.$createCommand=function(t,o,e){var i,n=e?this.tooltipEl:this.moreOptionsEl,s=[],r=o.bindKey;r&&("object"==typeof r&&(r=h.isMac?r.mac:r.win),s=(s=(r=r.split("|")[0]).split("-")).map((function(t){if(g[t]){if("string"==typeof g[t])return g[t];if(h.isMac&&g[t].mac)return g[t].mac}return t}))),e&&o.iconCssClass?i=["div",{class:["ace_icon_svg",o.iconCssClass].join(" "),"aria-label":o.name+" ("+o.bindKey+")"}]:(i=[["div",{class:c}],["div",{class:p},o.name]],s.length&&i.push(["div",{class:m},s.map((function(t){return["div",t]}))])),a.buildDom(["div",{class:[d,o.cssClass||""].join(" "),ref:t},i],n,this.elements),this.commands[t]=o;var l=function(e){this.editor&&this.editor.focus(),this.$shouldHideMoreOptions=this.isMoreOptionsShown(),!this.elements[t].disabled&&o.exec&&o.exec(this.editor),this.$shouldHideMoreOptions&&this.$setMoreOptionsVisibility(!1),this.update(),e.preventDefault()}.bind(this);this.eventListeners[t]=l,this.elements[t].addEventListener("click",l.bind(this)),this.$updateElement(t)},CommandBarTooltip.prototype.$setMoreOptionsVisibility=function(t){t?(this.moreOptions.setTheme(this.editor.renderer.theme),this.moreOptions.setClassName("command_bar_tooltip_wrapper"),this.moreOptions.show(),this.update(),this.updatePosition()):this.moreOptions.hide()},CommandBarTooltip.prototype.$onEditorChangeSession=function(t){t.oldSession&&(t.oldSession.off("changeScrollTop",this.$onChangeScroll),t.oldSession.off("changeScrollLeft",this.$onChangeScroll)),this.detach()},CommandBarTooltip.prototype.$onChangeScroll=function(){this.editor.renderer&&(this.isShown()||this.getAlwaysShow())&&this.editor.renderer.once("afterRender",this.updatePosition.bind(this))},CommandBarTooltip.prototype.$onMouseMove=function(t){if(!this.$mouseInTooltip){var o=this.editor.getCursorPosition(),e=this.editor.renderer.textToScreenCoordinates(o.row,o.column),i=this.editor.renderer.lineHeight;t.clientY>=e.pageY&&t.clientY<e.pageY+i?(this.isShown()||this.$showTooltipTimer.isPending()||this.$showTooltipTimer.delay(),this.$hideTooltipTimer.isPending()&&this.$hideTooltipTimer.cancel()):(this.isShown()&&!this.$hideTooltipTimer.isPending()&&this.$hideTooltipTimer.delay(),this.$showTooltipTimer.isPending()&&this.$showTooltipTimer.cancel())}},CommandBarTooltip.prototype.$preventMouseEvent=function(t){this.editor&&this.editor.focus(),t.preventDefault()},CommandBarTooltip.prototype.$scheduleTooltipForHide=function(){this.$mouseInTooltip=!1,this.$showTooltipTimer.cancel(),this.$hideTooltipTimer.delay()},CommandBarTooltip.prototype.$tooltipEnter=function(){this.$mouseInTooltip=!0,this.$showTooltipTimer.isPending()&&this.$showTooltipTimer.cancel(),this.$hideTooltipTimer.isPending()&&this.$hideTooltipTimer.cancel()},CommandBarTooltip.prototype.$updateOnHoverHandlers=function(t){var o=this.tooltip.getElement(),e=this.moreOptions.getElement();t?(this.editor&&(this.editor.on("mousemove",this.$onMouseMove),this.editor.renderer.getMouseEventTarget().addEventListener("mouseout",this.$scheduleTooltipForHide,!0)),o.addEventListener("mouseenter",this.$tooltipEnter),o.addEventListener("mouseleave",this.$scheduleTooltipForHide),e.addEventListener("mouseenter",this.$tooltipEnter),e.addEventListener("mouseleave",this.$scheduleTooltipForHide)):(this.editor&&(this.editor.off("mousemove",this.$onMouseMove),this.editor.renderer.getMouseEventTarget().removeEventListener("mouseout",this.$scheduleTooltipForHide,!0)),o.removeEventListener("mouseenter",this.$tooltipEnter),o.removeEventListener("mouseleave",this.$scheduleTooltipForHide),e.removeEventListener("mouseenter",this.$tooltipEnter),e.removeEventListener("mouseleave",this.$scheduleTooltipForHide))},CommandBarTooltip.prototype.$showTooltip=function(){this.isShown()||(this.tooltip.setTheme(this.editor.renderer.theme),this.tooltip.setClassName("command_bar_tooltip_wrapper"),this.tooltip.show(),this.update(),this.updatePosition(),this._signal("show"))},CommandBarTooltip.prototype.$hideTooltip=function(){this.$mouseInTooltip=!1,this.isShown()&&(this.moreOptions.hide(),this.tooltip.hide(),this._signal("hide"))},CommandBarTooltip.prototype.$updateElement=function(t){var o=this.commands[t];if(o){var e=this.elements[t],i=o.enabled;if("function"==typeof i&&(i=i(this.editor)),"function"==typeof o.getValue){var n=o.getValue(this.editor);if("text"===o.type)e.textContent=n;else if("checkbox"===o.type){var s=n?a.addCssClass:a.removeCssClass,r=e.parentElement===this.tooltipEl;e.ariaChecked=n,r?s(e,"ace_selected"):s(e=e.querySelector("."+c),"ace_checkmark")}}i&&e.disabled?(a.removeCssClass(e,"ace_disabled"),e.ariaDisabled=e.disabled=!1,e.removeAttribute("disabled")):i||e.disabled||(a.addCssClass(e,"ace_disabled"),e.ariaDisabled=e.disabled=!0,e.setAttribute("disabled",""))}},CommandBarTooltip}();l.implement(v.prototype,s),a.importCssString("\n.ace_tooltip.".concat(u,"_wrapper {\n    padding: 0;\n}\n\n.ace_tooltip .").concat(u," {\n    padding: 1px 5px;\n    display: flex;\n    pointer-events: auto;\n}\n\n.ace_tooltip .").concat(u,".tooltip_more_options {\n    padding: 1px;\n    flex-direction: column;\n}\n\ndiv.").concat(d," {\n    display: inline-flex;\n    cursor: pointer;\n    margin: 1px;\n    border-radius: 2px;\n    padding: 2px 5px;\n    align-items: center;\n}\n\ndiv.").concat(d,".ace_selected,\ndiv.").concat(d,":hover:not(.ace_disabled) {\n    background-color: rgba(0, 0, 0, 0.1);\n}\n\ndiv.").concat(d,".ace_disabled {\n    color: #777;\n    pointer-events: none;\n}\n\ndiv.").concat(d," .ace_icon_svg {\n    height: 12px;\n    background-color: #000;\n}\n\ndiv.").concat(d,".ace_disabled .ace_icon_svg {\n    background-color: #777;\n}\n\n.").concat(u,".tooltip_more_options .").concat(d," {\n    display: flex;\n}\n\n.").concat(u,".").concat(c," {\n    display: none;\n}\n\n.").concat(u,".tooltip_more_options .").concat(c," {\n    display: inline-block;\n    width: 12px;\n}\n\n.").concat(p," {\n    display: inline-block;\n}\n\n.").concat(m," {\n    margin: 0 2px;\n    display: inline-block;\n    font-size: 8px;\n}\n\n.").concat(u,".tooltip_more_options .").concat(m," {\n    margin-left: auto;\n}\n\n.").concat(m," div {\n    display: inline-block;\n    min-width: 8px;\n    padding: 2px;\n    margin: 0 1px;\n    border-radius: 2px;\n    background-color: #ccc;\n    text-align: center;\n}\n\n.ace_dark.ace_tooltip .").concat(u," {\n    background-color: #373737;\n    color: #eee;\n}\n\n.ace_dark div.").concat(d,".ace_disabled {\n    color: #979797;\n}\n\n.ace_dark div.").concat(d,".ace_selected,\n.ace_dark div.").concat(d,":hover:not(.ace_disabled) {\n    background-color: rgba(255, 255, 255, 0.1);\n}\n\n.ace_dark div.").concat(d," .ace_icon_svg {\n    background-color: #eee;\n}\n\n.ace_dark div.").concat(d,".ace_disabled .ace_icon_svg {\n    background-color: #979797;\n}\n\n.ace_dark .").concat(d,".ace_disabled {\n    color: #979797;\n}\n\n.ace_dark .").concat(m," div {\n    background-color: #575757;\n}\n\n.ace_checkmark::before {\n    content: '✓';\n}\n"),"commandbar.css",!1),o.CommandBarTooltip=v,o.TOOLTIP_CLASS_NAME=u,o.BUTTON_CLASS_NAME=d})),ace.require(["ace/ext/command_bar"],(function(t){"object"==typeof module&&"object"==typeof exports&&module&&(module.exports=t)}));